---
title: Arch安装
date: 2019-09-06 09:46:03
categories:
- 装机配置
tags:
---
# 说明
1.系统：小米笔记本pro 8+256 MX150
2.此blog为安装archlinux单系统
3.默认已制作好usb启动盘，并且已经在BIOS界面设置usb启动盘为默认启动项

---
# 安装
## 联网
### 无线
`wifi-menu`
### 有线
`systemctl start dhcpcd`
## 更新系统时间
```
timedatectl set-ntp true
timedatectl status	检查服务状态
```
## 创建、格式化、挂载分区
### 查看(以下方法均可)
```
fdisk -l
parted -l
lsblk
```
### 创建(此blog使用parted创建分区)
```
parted /dev/nvme0n1
(parted) mklabel gpt
(parted) mkpart ESP fat32 1MiB 513MiB                   EFI系统分区
(parted) set 1 boot on
(parted) mkpart primary ext4 513MiB 60.5GiB             /
(parted) mkpart primary linux-swap 60.5GiB 68.5GiB      swap
(parted) mkpart primary ext4 68.5GiB 100%               /home
```
### 格式化
```
mkfs.vfat -F32 /dev/nvme0n1px       格式化EFI分区
mkfs.ext4 /dev/nvme0n1px            格式化根分区
mkswap /dev/nvme0n1px               格式化swap分区
swapon /dev/nvme0n1px               打开swap分区
mkfs.ext4 /dev/nvme0n1px            格式化home分区
```
### 挂载
```
mount /dev/nvme0n1px /mnt                   挂载根分区
mkdir /mnt/home
mount /dev/nvme0n1px /mnt/home              挂载home分区
mkdir /mnt/boot
mkdir /mnt/boot/EFI
mount /dev/nvme0n1px /mnt/boot/EFI          挂载EFI系统分区
```
## 更换国内镜像源
1.进入https://www.archlinux.org/mirrorlist
2.Country选择China
3.点击Generate List
4.code
```
wget -O /etc/pacman.d/mirrorlist "完成3后跳转网站的网址"
cat /etc/pacman.d/mirrorlist
sed -i "s/#Server/Server/g" /etc/pacman.d/mirrorlist
cat /etc/pacman.d/mirrorlist
```
## 安装基础包
`pacstrap /mnt base base-devel`
## 生成fstab
```
genfstab -U /mnt >> /mnt/etc/fstab
cat /mnt/etc/fstab                           检查生成的文件是否正确
```
## 进入新安装的系统
`arch-chroot /mnt`
## 时区
```
ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
hwclock --systohc                                               同步本地时间
date -R                                                         查看时间
```
## 本地化
```
vi /etc/locale.gen                               找到下面两行移除前面的#号并保存退出
	en_US.UTF-8 UTF-8
	zh_CN.UTF-8 UTF-8
locale-gen
echo "LANG=en_US.UTF-8" > /etc/locale.conf       设置环境变量为英文
```
## 网络
```
echo "archlinux" > /etc/hostname                            设置计算机主机名
vi /etc/hosts                                               添加下面三行到hosts
	127.0.0.1   localhost
	::1         localhost
	127.0.0.1   archlinux.localdomain archlinux
```
## root与普通账户
```
passwd                                  root密码
useradd -m -G wheel jiaop               添加普通用户
passwd jiaop                            普通用户密码
```
## 安装必要包
```
pacman -S iw wpa_supplicant dialog      wifi联网
pacman -S intel-ucode                   intel微码
```
## 引导
```
pacman -S grub efibootmgr
grub-install --target=x86_64-efi --efi-directory=/boot/EFI --bootloader-id=GRUB
grub-mkconfig -o /boot/grub/grub.cfg
```
## 重启
```
exit                    退出chroot环境
umount -R /mnt          卸载被挂载的分区
reboot                  重启并拔出u盘
```
---
# 链接
- [跟着官方文档，手把手教你安装 Arch Linux 2019](https://www.bilibili.com/video/av56970488)
- [[真机2019]超详细手把手最新版ArchLinux安装教程](https://www.bilibili.com/video/av45282571/?spm_id_from=333.788.videocard.0)
- [Arch Linux 安装手册/傻瓜书/教程/指南](https://www.jianshu.com/p/6fe59c24b3df?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes&utm_source=recommendation)
- [Installation guide (简体中文)](https://wiki.archlinux.org/index.php/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87))
- [Users and groups (简体中文)](https://wiki.archlinux.org/index.php/Users_and_groups_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E6%B7%BB%E5%8A%A0%E7%99%BB%E5%BD%95%E7%94%A8%E6%88%B7)
- [useradd命令](https://man.linuxde.net/useradd)
- [netctl (简体中文)](https://wiki.archlinux.org/index.php/Netctl_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87))
- [Shell echo命令](https://www.runoob.com/linux/linux-shell-echo.html)
